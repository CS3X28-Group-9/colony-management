{% extends "base.html" %}
{% block title %}Import form{% endblock %}
{% block content %}

  <div class="p-4 m-4 sm:p-6 lg:p-8 rounded bg-neutral-200 w-max shadow-md border border-neutral-300">
    <h1>Mouse Excel Import</h1>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <div class="">
        <label for="{{ form.project.id_for_project }}" class="w-max">
          Project - Project that owns the imported mice.</label
          >
          <select
            name="{{ form.project.html_name }}"
            id="{{ form.project.id_for_label }}"
            class="bg-white w-max"
            required
          >
            <option>Select a project</option>
            {% for project in user.leading_set.all %}
              <option value="{{ project.id }}">{{ project.name }}</option>
            {% endfor %}
          </select>
          <br />
          <label for="file-input" class="sr-only w-max">Choose file</label>
          <input
            type="file"
            name="file-input"
            id="file-input"
            class="block w-full border border-gray-200 shadow-sm rounded-lg text-sm focus:z-10 focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400 file:bg-gray-50 file:border-0 file:me-4 file:py-3 file:px-4"
          />

          <br />
          <label for="{{ form.sheet_name.id_for_label }}" class="w-max">
            Sheet name - Leave blank to use the active worksheet.</label
            >
            <br />
            <label for="{{ form.cell_range.id_for_label }}" class="w-max">
              Cell range - Excel range such as "A1:M40".</label
              >
            </div>
            <button type="submit" class="btn-primary">Upload</button>
          </form>
        </div>

        {% if messages %}
          <ul>
            {% for m in messages %}
              <li>{{ m }}</li>
            {% endfor %}
          </ul>
        {% endif %} {% endblock %}
